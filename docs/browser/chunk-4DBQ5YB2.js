import{A as li,B as si,C as mi,D as ci,E as di,F as pi,G as ui,I as hi,K as _i,L as gi,M as fi,O as xi,a as pe,b as Lt,c as Kt,d as Bt,e as Yt,f as Qt,g as qt,h as Jt,i as Xt,j as Wt,k as Ne,l as Zt,m as ue,o as ei,p as Ue,u as ti,v as ni,w as he,x as oi,y as ai,z as ri}from"./chunk-DWDO47IJ.js";import{G as J,M as Ri,P as ii,a as Re,i as Oe,n as zt,r as Nt,s as Ut}from"./chunk-RZNJ3GF3.js";import{a as je}from"./chunk-JMB7VPA3.js";import{$a as r,$d as At,Ab as N,Ba as gt,Bb as I,Be as ze,Cb as R,Cd as kt,Ce as Gt,D as mt,Dc as U,E as fe,Fc as We,Ga as d,Ha as x,Hc as j,Hd as Pt,I as ct,Ic as ae,Ja as xe,K as dt,Ka as D,Lc as Ve,Ma as P,Mb as q,Mc as re,Na as B,Nb as bt,Nc as le,Oa as ft,Oc as St,Pa as _,Pb as Tt,Pc as se,Q as Ke,Qa as Ye,Qc as me,Ra as p,Rc as yt,Sa as xt,Sc as wt,Ta as ve,Tc as Et,Td as It,Ua as M,Uc as Ft,Va as ke,Wc as H,Wd as Vt,X as pt,Xa as y,Y as Fe,Yc as Ae,Z,Za as ee,Zc as $,Zd as O,_ as ut,_a as te,aa as z,ab as l,ac as Xe,ae as ce,ba as k,bb as S,bc as Ie,be as Rt,ca as Me,cb as V,da as K,db as A,de as Ot,f as we,fa as De,fb as w,g as Ee,ga as u,gd as Mt,ge as Ze,ha as h,he as et,ib as b,je as Ce,k as W,ka as ht,kb as m,ke as be,la as _t,lb as Qe,mb as Y,me as tt,ob as vt,pb as Ct,q as st,qb as qe,rb as Pe,sa as Be,sb as ie,se as it,tb as ne,te as de,ub as Je,uc as F,vb as s,vc as oe,vd as Dt,ve as jt,wb as Q,xb as E,ye as Ht,ze as $t}from"./chunk-HK3YRTRN.js";var vi=[{id:1,option:"104 - Permesso Legge 104"},{id:2,option:"FES - Festivo"},{id:3,option:"MLT - Malattia"},{id:4,option:"INF - Infortunio"},{id:5,option:"MAT - Maternit\xE0"},{id:6,option:"CMT - Congedo Matrimoniale"},{id:7,option:"LUT - Lutto"},{id:8,option:"PNR - Permesso non Retribuito"},{id:9,option:"ASP - Aspettativa"},{id:10,option:"ANR - Aspettiva non Retribuita"},{id:11,option:"FRM - Formazione"},{id:12,option:"CIG - Cassa Integrazione"}];var G=(()=>{let n=class n{constructor(e){this.http=e}getAllTimesheetOptionList(){return this.http.get(`${F.apiUrl}/${F.servizi.impiegato.getAllTimesheetOption}`)}getAllTimesheetList(){return this.http.get(`${F.apiUrl}/${F.servizi.impiegato.getAllTimesheetLogged}`)}submitYearMonthTimesheetSearch(e){return this.http.post(`${F.apiUrl}/${F.servizi.impiegato.submitPeriodTimesheet}`,e)}submitPeriodoTimesheet(e){return this.http.get(`${F.apiUrl}/${F.servizi.impiegato.submitOptionTimesheet}`+e)}submitDatoTImesheet(e){return this.http.put(`${F.apiUrl}/${F.servizi.impiegato.submitDatoTimesheet}`,e)}submitTimesheetNoSave(e){return this.http.get(`${F.apiUrl}/${F.servizi.impiegato.submitTimesheetNoSave}`+e)}submitTimesheet(e){return this.http.put(`${F.apiUrl}/${F.servizi.impiegato.submitTimesheet}`,e)}submitNgiustificativi(e,i){return this.http.put(`${F.apiUrl}/${F.servizi.impiegato.updateNgiustificativo}`+i,e)}submitGiustificativoTimesheet(e,i){let a=new Xe({});return this.http.post(`${F.apiUrl}/${F.servizi.file.submitGiustificativoFiles}/${e}`,i,{headers:a})}submitAllegatoTimesheet(e,i,a){let c=new Xe({}),g={file:i,comment:a,idTimesheet:e};return this.http.post(`${F.apiUrl}/${F.servizi.file.submitAllegatoFile}`,g,{headers:c})}};n.\u0275fac=function(i){return new(i||n)(ut(Ie))},n.\u0275prov=pt({token:n,factory:n.\u0275fac,providedIn:"root"});let t=n;return t})();function zi(t,n){t&1&&(r(0,"mat-header-cell"),s(1," Giorno "),l())}function Ni(t,n){if(t&1&&(r(0,"mat-cell"),s(1),l()),t&2){let o=n.$implicit,e=m();M(e.disableMargin?"border-right: solid 1px #e0e0e0;":""),d(),E(" ",o.get("ngiorno").value," ")}}function Ui(t,n){t&1&&(r(0,"mat-header-cell",18),s(1," Sede "),l())}function ji(t,n){if(t&1&&s(0),t&2){let o=m().$implicit;E(" ",o.get("sede").value," ")}}function Hi(t,n){if(t&1){let o=w();r(0,"input",19),b("change",function(){u(o);let i=m().index,a=m();return h(a.updateField(i,"sede"))}),l()}if(t&2){let o=m().$implicit;p("formControl",o.get("sede"))}}function $i(t,n){if(t&1&&(r(0,"mat-cell"),_(1,ji,1,1)(2,Hi,1,1),l()),t&2){let o=n.$implicit,e=m();M(e.disableMargin?"border-right: solid 1px #e0e0e0;":""),d(),y(1,o.get("altro").value=="FES"?1:2)}}function Gi(t,n){t&1&&(r(0,"mat-header-cell",18),s(1," Clienti "),l())}function Li(t,n){if(t&1){let o=w();r(0,"mat-cell")(1,"input",19),b("change",function(){let a=u(o).index,c=m();return h(c.updateField(a,"clienteOre"))}),l()()}if(t&2){let o=n.$implicit,e=m();M(e.disableMargin?"border-right: solid 1px #e0e0e0;":""),d(),p("formControl",o.get("clienteOre"))}}function Ki(t,n){t&1&&(r(0,"mat-header-cell",18),s(1," Straordinari "),l())}function Bi(t,n){if(t&1){let o=w();r(0,"mat-cell")(1,"input",19),b("change",function(){let a=u(o).index,c=m();return h(c.updateField(a,"straordinari"))}),l()()}if(t&2){let o=n.$implicit,e=m();M(e.disableMargin?"border-right: solid 1px #e0e0e0;":""),d(),p("formControl",o.get("straordinari"))}}function Yi(t,n){t&1&&(r(0,"mat-header-cell",18),s(1," Ferie "),l())}function Qi(t,n){if(t&1&&s(0),t&2){let o=m().$implicit;E(" ",o.get("ferie").value," ")}}function qi(t,n){if(t&1){let o=w();r(0,"input",19),b("change",function(){u(o);let i=m().index,a=m();return h(a.updateField(i,"ferie"))}),l()}if(t&2){let o=m().$implicit;p("formControl",o.get("ferie"))}}function Ji(t,n){if(t&1&&(r(0,"mat-cell"),_(1,Qi,1,1)(2,qi,1,1),l()),t&2){let o=n.$implicit,e=m();M(e.disableMargin?"border-right: solid 1px #e0e0e0;":""),d(),y(1,o.get("altro").value=="FES"?1:2)}}function Xi(t,n){t&1&&(r(0,"mat-header-cell",18),s(1," Permessi "),l())}function Wi(t,n){if(t&1&&s(0),t&2){let o=m().$implicit;E(" ",o.get("permessi").value," ")}}function Zi(t,n){if(t&1){let o=w();r(0,"input",19),b("change",function(){u(o);let i=m().index,a=m();return h(a.updateField(i,"permessi"))}),l()}if(t&2){let o=m().$implicit;p("formControl",o.get("permessi"))}}function en(t,n){if(t&1&&(r(0,"mat-cell"),_(1,Wi,1,1)(2,Zi,1,1),l()),t&2){let o=n.$implicit,e=m();M(e.disableMargin?"border-right: solid 1px #e0e0e0;":""),d(),y(1,o.get("altro").value=="FES"?1:2)}}function tn(t,n){t&1&&(r(0,"mat-header-cell",18),s(1," Altro "),l())}function nn(t,n){return this.optionsAltro}function on(t,n){if(t&1&&(r(0,"option",25),s(1),l()),t&2){let o=n.$implicit;p("value",o.id),d(),E(" ",o.option," ")}}function an(t,n){if(t&1){let o=w();r(0,"select",23),b("change",function(){u(o);let i=m().index,a=m();return h(a.updateField(i,"altro"))}),r(1,"option",24),s(2,"Seleziona Periodo"),l(),ee(3,on,2,2,"option",25,nn,!0),l()}if(t&2){let o=m().$implicit,e=m();p("formControl",o.get("altro")),d(3),te(e.optionsAltro)}}function rn(t,n){if(t&1&&(r(0,"mat-cell",20)(1,"div",21),_(2,an,5,1,"select",22),l()()),t&2){let o=n.$implicit,e=m();M(e.disableMargin?"border-right: solid 1px #e0e0e0;":""),d(2),y(2,o.get("altro").value!="FES"?2:-1)}}function ln(t,n){t&1&&(r(0,"mat-header-cell",18),s(1," Totale ore "),l())}function sn(t,n){if(t&1&&(r(0,"mat-cell"),s(1),l()),t&2){let o=n.$implicit,e=m();M(e.disableMargin?"border-right: solid 1px #e0e0e0;":""),ke(o.get("tot").value<8&&o.get("altro").value!="FES"&&o.get("altro").value!="2"?"blinkingYellowBackground":""),d(),E(" ",o.get("tot").value," ")}}function mn(t,n){t&1&&(r(0,"mat-header-cell",18),s(1," Cliente "),l())}function cn(t,n){if(t&1){let o=w();r(0,"mat-cell")(1,"input",29),b("change",function(){let a=u(o).index,c=m(2);return h(c.updateField(a,"clienteDest"))}),l()()}if(t&2){let o=n.$implicit,e=m(2);M(e.disableMargin?"border-right: solid 1px #e0e0e0;":""),d(),p("formControl",o.get("clienteDest"))}}function dn(t,n){t&1&&(r(0,"mat-header-cell",18),s(1," Destinazione "),l())}function pn(t,n){if(t&1&&s(0),t&2){let o=m().$implicit;E(" ",o.get("destinazione").value," ")}}function un(t,n){if(t&1){let o=w();r(0,"input",29),b("change",function(){u(o);let i=m().index,a=m(2);return h(a.updateField(i,"destinazione"))}),l()}if(t&2){let o=m().$implicit;p("formControl",o.get("destinazione"))}}function hn(t,n){if(t&1&&(r(0,"mat-cell"),_(1,pn,1,1)(2,un,1,1),l()),t&2){let o=n.$implicit,e=m(2);M(e.disableMargin?"border-right: solid 1px #e0e0e0;":""),d(),y(1,o.get("altro").value=="FES"?1:2)}}function _n(t,n){t&1&&(r(0,"mat-header-cell",18),s(1," Km Percorsi "),l())}function gn(t,n){if(t&1&&s(0),t&2){let o=m().$implicit;E(" ",o.get("destinazione").value," ")}}function fn(t,n){if(t&1){let o=w();r(0,"input",30),b("change",function(){u(o);let i=m().index,a=m(2);return h(a.updateField(i,"kmP"))}),l()}if(t&2){let o=m().$implicit;p("formControl",o.get("kmP"))}}function xn(t,n){if(t&1&&(r(0,"mat-cell"),_(1,gn,1,1)(2,fn,1,1),l()),t&2){let o=n.$implicit,e=m(2);M(e.disableMargin?"border-right: solid 1px #e0e0e0;":""),d(),y(1,o.get("altro").value=="FES"?1:2)}}function vn(t,n){t&1&&(V(0,26),_(1,mn,2,0,"mat-header-cell",7)(2,cn,2,3,"mat-cell",5),A(),V(3,27),_(4,dn,2,0,"mat-header-cell",7)(5,hn,3,3,"mat-cell",5),A(),V(6,28),_(7,_n,2,0,"mat-header-cell",7)(8,xn,3,3,"mat-cell",5),A())}function Cn(t,n){t&1&&S(0,"mat-header-row")}var bn=()=>({"background-color":"red"}),Tn=()=>({});function Sn(t,n){if(t&1&&S(0,"mat-row"),t&2){let o=n.$implicit;M(o.get("altro").value==="FES"||o.get("altro").value==="2"?R(2,bn):R(3,Tn))}}var $e=(()=>{let n=class n extends O{emitEvent(e){this.myEvent.emit(e)}emitEventEditKm(e){this.myEvent2.emit(e)}emitTImesheet(e){this.timesheetEvent.emit(e)}constructor(e,i,a,c,g){super(),this.http=e,this.fb=i,this.impiegatoService=a,this.authService=c,this.snackBar=g,this.myEvent=new D,this.myEvent2=new D,this.timesheetEvent=new D,this.orePermesso=new D,this.oreFerie=new D,this.displayedColumns=["ngiorno","sede","clienteOre","straordinari","ferie","permessi","altro","tot"],this.timeValidator=v=>T=>{let C=T.parent;if(!C)return null;let f=0;return["sede","clienteOre","ferie","permessi"].forEach(Ai=>{let ge=C.get(Ai);ge&&ge.value!==null&&ge.value!==""&&!isNaN(+ge.value)&&(f+=+ge.value)}),f>this.currentUser.oreLavorative?{exceedTime:!0}:null},this.maxWorkHoursValidator=v=>T=>T.value&&!isNaN(+T.value)&&T.value!==null&&T.value!==""&&+T.value>v?{exceededPermessi:!0}:null,this.validatorPermessi=()=>v=>v.value&&!isNaN(+v.value)&&v.value!==null&&v.value!==""&&this.rimanenzaPermesso-v.value<0?{exceededPermessi:!0}:null,this.validatorFerie=()=>v=>v.value&&!isNaN(+v.value)&&v.value!==null&&v.value!==""&&this.rimanenzaFerie-v.value<0?{exceededFerie:!0}:null,this.kmPholder=[],this.JSON=JSON,this.optionsAltro=vi,this.timesheetForm=this.fb.group({rows:this.fb.array([])})}get currentUser(){return this.authService.currentUserValue}ngOnInit(){this.currentUser.rimborso&&this.displayedColumns.push("clienteDest","destinazione","kmP");let e=this.timesheetForm.controls.rows,i=this.rimanenzaFerie,a=this.rimanenzaPermesso;this.timesheet.datiTimesheet.forEach(c=>{let g=this.fb.group({}),v=0,T=0;Object.keys(c).forEach(C=>{let f=this.fb.control(c[C],[C!="straordinari"?this.timeValidator(C):this.maxWorkHoursValidator(this.authService.currentUserValue.oreLavorative)]);g.addControl(C,f),["sede","clienteOre","straordinari","ferie","permessi","altro"].includes(C)&&(C==="altro"?T+=c[C]!=""?this.authService.currentUserValue.oreLavorative:0:(["ferie","permessi"].includes(C)&&(C==="ferie"?i-=Number(c[C])||0:C==="permessi"&&(a-=Number(c[C])||0)),T+=Number(c[C])||0))}),v+=Number(c.kmP)||0,this.kmPholder.push(Number(c.kmP)||0),this.emitEvent({km:v}),g.addControl("tot",this.fb.control(T)),e.push(g)}),this.oreFerie.emit({action:i}),this.orePermesso.emit({action:a}),this.dataSource=new hi(this.timesheetForm.get("rows").controls)}updateField(e,i){let a=this.timesheetForm.controls.rows.at(e);if(a.controls[i].valid){let c=0,g=!1;if(i=="altro"){let T=a.controls.altro;T&&T.value==="2"?(["sede","ferie","permessi","clienteDest","destinazione","kmP"].forEach(C=>{let f=a.controls[C];f&&(f.setValue(""),f.disable())}),c=0):T.value!=" "&&T.value!=""?(["sede","clienteOre","straordinari","ferie","permessi","clienteDest","destinazione","kmP"].forEach(C=>{let f=a.controls[C];f&&(f.setValue(""),f.disable())}),c+=8):(["sede","clienteOre","straordinari","ferie","permessi","clienteDest","destinazione","kmP"].forEach(C=>{let f=a.controls[C];f&&f.enable()}),T.setValue(""),c=0)}else if(i=="kmP"){["sede","clienteOre","straordinari","ferie","permessi"].forEach(C=>{let f=a.controls[C];f&&f.value!==null&&f.value!==""&&!isNaN(+f.value)&&(c+=Number(f.value))});let T=a.controls.kmP;this.emitEventEditKm({km:this.kmPholder[e]}),this.kmPholder[e]=Number(T.value)||0,this.emitEvent({km:Number(T.value)||0})}else{let T=a.controls[i];switch(i){case"permessi":T&&T.value!==null&&T.value!==""&&!isNaN(+T.value)?this.rimanenzaPermesso-=T.value:(this.rimanenzaPermesso=this.authService.currentUserValue.anagraficaLavorativa[0].giorniPermesso,this.timesheetForm.controls.rows.value.forEach(C=>{this.rimanenzaPermesso-=Number(C.permessi)||0})),this.orePermesso.emit({action:this.rimanenzaPermesso});break;case"ferie":T&&T.value!==null&&T.value!==""&&!isNaN(+T.value)?this.rimanenzaFerie-=T.value:(this.rimanenzaFerie=this.authService.currentUserValue.anagraficaLavorativa[0].giorniFerie,this.timesheetForm.controls.rows.value.forEach(C=>{this.rimanenzaFerie-=Number(C.ferie)||0})),this.oreFerie.emit({action:this.rimanenzaFerie});break}["sede","clienteOre","straordinari","permessi","ferie","altro"].forEach(C=>{let f=a.controls[C];C=="straordinari"?(g=!0,f&&f.value!==null&&f.value!==""&&!isNaN(+f.value)&&(c+=Number(f.value))):C!="altro"?f&&f.value!==null&&f.value!==""&&!isNaN(+f.value)&&(c+=Number(f.value)):f.value!==""&&(c+=this.authService.currentUserValue.oreLavorative)})}this.emitTImesheet({dato:["clienteDest","destinazione"].includes(i)?a.controls[i].value:Number(a.controls[i].value),field:i,index:e});let v=a.controls.tot;(v&&!(c>this.currentUser.oreLavorative)||g)&&v.setValue(c)}else["exceededPermessi","exceededFerie"].includes(Object.keys(a.controls[i].errors||{})[0])?J("red","Ore Permesso/Ferie Superate","top","center",this.snackBar):J("red","Ore Lavorative Superate","top","center",this.snackBar),a.controls[i].setValue("")}isDisabled(e){let i=e.get("altro").value==="FES";return console.log(`input isDisabled = ${i}`),i}};n.\u0275fac=function(i){return new(i||n)(x(Ie),x(H),x(G),x(oe),x(he))},n.\u0275cmp=k({type:n,selectors:[["app-timesheet-dettaglio"]],inputs:{timesheet:"timesheet",disableMargin:"disableMargin",rimanenzaPermesso:"rimanenzaPermesso",rimanenzaFerie:"rimanenzaFerie"},outputs:{myEvent:"myEvent",myEvent2:"myEvent2",timesheetEvent:"timesheetEvent",orePermesso:"orePermesso",oreFerie:"oreFerie"},standalone:!0,features:[P,I],decls:30,vars:5,consts:[[1,"container-fluid"],[1,"row"],["stickyHeader","",2,"width","100%",3,"dataSource"],["matColumnDef","ngiorno"],[4,"matHeaderCellDef"],[3,"style",4,"matCellDef"],["matColumnDef","sede"],["mat-sticky","",4,"matHeaderCellDef"],["matColumnDef","clienteOre"],["matColumnDef","straordinari"],["matColumnDef","ferie"],["matColumnDef","permessi"],["matColumnDef","altro"],["class","cell",3,"style",4,"matCellDef"],["matColumnDef","tot"],[3,"class","style",4,"matCellDef"],[4,"matHeaderRowDef","matHeaderRowDefSticky"],[3,"style",4,"matRowDef","matRowDefColumns"],["mat-sticky",""],["type","number","min","0",3,"formControl","change"],[1,"cell"],[1,"form-group","select-container"],["class","custom-select",3,"formControl"],[1,"custom-select",3,"formControl","change"],["value"," "],[3,"value"],["matColumnDef","clienteDest"],["matColumnDef","destinazione"],["matColumnDef","kmP"],[3,"formControl","change"],["step","0.01","min","0","type","number",3,"formControl","change"]],template:function(i,a){i&1&&(r(0,"div",0)(1,"div",1)(2,"mat-table",2),V(3,3),_(4,zi,2,0,"mat-header-cell",4)(5,Ni,2,3,"mat-cell",5),A(),V(6,6),_(7,Ui,2,0,"mat-header-cell",7)(8,$i,3,3,"mat-cell",5),A(),V(9,8),_(10,Gi,2,0,"mat-header-cell",7)(11,Li,2,3,"mat-cell",5),A(),V(12,9),_(13,Ki,2,0,"mat-header-cell",7)(14,Bi,2,3,"mat-cell",5),A(),V(15,10),_(16,Yi,2,0,"mat-header-cell",7)(17,Ji,3,3,"mat-cell",5),A(),V(18,11),_(19,Xi,2,0,"mat-header-cell",7)(20,en,3,3,"mat-cell",5),A(),V(21,12),_(22,tn,2,0,"mat-header-cell",7)(23,rn,3,3,"mat-cell",13),A(),V(24,14),_(25,ln,2,0,"mat-header-cell",7)(26,sn,2,5,"mat-cell",15),A(),_(27,vn,9,0)(28,Cn,1,0,"mat-header-row",16)(29,Sn,1,4,"mat-row",17),l()()()),i&2&&(d(2),p("dataSource",a.dataSource),d(25),y(27,a.currentUser.rimborso?27:-1),d(),p("matHeaderRowDef",a.displayedColumns)("matHeaderRowDefSticky",!0),d(),p("matRowDefColumns",a.displayedColumns))},dependencies:[oi,si,mi,pi,ui,$,wt,Et,U,le,yt,j,Ft,St,ci,di,li,ri,ai],styles:[`mat-cell input{border:none;outline:none;width:100%;height:100%;box-sizing:border-box;padding:2px 5px;background:inherit;position:relative;z-index:1}.mat-table .mat-cell,.mat-table .mat-header-cell{border-right:solid 1px #e0e0e0}.mat-table .mat-cell:last-child,.mat-table .mat-header-cell:last-child{border-right:none!important}.mat-header-cell,.mat-cell{display:flex;justify-content:center;align-items:center;height:100%;width:100%;text-align:center}.mat-header-cell input,.mat-cell input{text-align:center}[class*=mat-column]{display:flex;justify-content:center;align-items:center;text-align:center}[class*=mat-column] input{width:100%;text-align:center}@keyframes blinkingAnimation{0%{background-color:transparent}50%{background-color:#ff0}to{background-color:transparent}}.blinkingYellowBackground{animation:blinkingAnimation 1s infinite}.mat-column-altro{flex:2!important}.cell{display:flex;justify-content:center;align-items:center;padding:0!important;height:100%}.select-container{padding-top:15%;width:100%;height:100%;display:flex;justify-content:center}.custom-select{width:100%;height:100%;background-color:transparent;border:none}
`],encapsulation:2});let t=n;return t})();var L=we(it());var wn=0,ot=new Z("CdkAccordion"),Ti=(()=>{let n=class n{constructor(){this._stateChanges=new W,this._openCloseAllActions=new W,this.id=`cdk-accordion-${wn++}`,this.multi=!1}openAll(){this.multi&&this._openCloseAllActions.next(!0)}closeAll(){this._openCloseAllActions.next(!1)}ngOnChanges(e){this._stateChanges.next(e)}ngOnDestroy(){this._stateChanges.complete(),this._openCloseAllActions.complete()}};n.\u0275fac=function(i){return new(i||n)},n.\u0275dir=K({type:n,selectors:[["cdk-accordion"],["","cdkAccordion",""]],inputs:{multi:[z.HasDecoratorInputTransform,"multi","multi",q]},exportAs:["cdkAccordion"],standalone:!0,features:[N([{provide:ot,useExisting:n}]),B,De]});let t=n;return t})(),En=0,Si=(()=>{let n=class n{get expanded(){return this._expanded}set expanded(e){if(this._expanded!==e){if(this._expanded=e,this.expandedChange.emit(e),e){this.opened.emit();let i=this.accordion?this.accordion.id:this.id;this._expansionDispatcher.notify(this.id,i)}else this.closed.emit();this._changeDetectorRef.markForCheck()}}constructor(e,i,a){this.accordion=e,this._changeDetectorRef=i,this._expansionDispatcher=a,this._openCloseAllSubscription=Ee.EMPTY,this.closed=new D,this.opened=new D,this.destroyed=new D,this.expandedChange=new D,this.id=`cdk-accordion-child-${En++}`,this._expanded=!1,this.disabled=!1,this._removeUniqueSelectionListener=()=>{},this._removeUniqueSelectionListener=a.listen((c,g)=>{this.accordion&&!this.accordion.multi&&this.accordion.id===g&&this.id!==c&&(this.expanded=!1)}),this.accordion&&(this._openCloseAllSubscription=this._subscribeToOpenCloseAllActions())}ngOnDestroy(){this.opened.complete(),this.closed.complete(),this.destroyed.emit(),this.destroyed.complete(),this._removeUniqueSelectionListener(),this._openCloseAllSubscription.unsubscribe()}toggle(){this.disabled||(this.expanded=!this.expanded)}close(){this.disabled||(this.expanded=!1)}open(){this.disabled||(this.expanded=!0)}_subscribeToOpenCloseAllActions(){return this.accordion._openCloseAllActions.subscribe(e=>{this.disabled||(this.expanded=e)})}};n.\u0275fac=function(i){return new(i||n)(x(ot,12),x(xe),x(Oe))},n.\u0275dir=K({type:n,selectors:[["cdk-accordion-item"],["","cdkAccordionItem",""]],inputs:{expanded:[z.HasDecoratorInputTransform,"expanded","expanded",q],disabled:[z.HasDecoratorInputTransform,"disabled","disabled",q]},outputs:{closed:"closed",opened:"opened",destroyed:"destroyed",expandedChange:"expandedChange"},exportAs:["cdkAccordionItem"],standalone:!0,features:[N([{provide:ot,useValue:void 0}]),B]});let t=n;return t})(),yi=(()=>{let n=class n{};n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=Me({type:n}),n.\u0275inj=Fe({});let t=n;return t})();var Dn=["body"];function kn(t,n){}var Pn=[[["mat-expansion-panel-header"]],"*",[["mat-action-row"]]],In=["mat-expansion-panel-header","*","mat-action-row"];function Vn(t,n){if(t&1&&S(0,"span",2),t&2){let o=m();p("@indicatorRotate",o._getExpandedState())}}var An=[[["mat-panel-title"]],[["mat-panel-description"]],"*"],Rn=["mat-panel-title","mat-panel-description","*"],at=new Z("MAT_ACCORDION"),wi="225ms cubic-bezier(0.4,0.0,0.2,1)",Ei={indicatorRotate:Ze("indicatorRotate",[be("collapsed, void",Ce({transform:"rotate(0deg)"})),be("expanded",Ce({transform:"rotate(180deg)"})),tt("expanded <=> collapsed, void => collapsed",et(wi))]),bodyExpansion:Ze("bodyExpansion",[be("collapsed, void",Ce({height:"0px",visibility:"hidden"})),be("expanded",Ce({height:"*",visibility:""})),tt("expanded <=> collapsed, void => collapsed",et(wi))])},Fi=new Z("MAT_EXPANSION_PANEL"),On=(()=>{let n=class n{constructor(e,i){this._template=e,this._expansionPanel=i}};n.\u0275fac=function(i){return new(i||n)(x(Ct),x(Fi,8))},n.\u0275dir=K({type:n,selectors:[["ng-template","matExpansionPanelContent",""]],standalone:!0});let t=n;return t})(),zn=0,Mi=new Z("MAT_EXPANSION_PANEL_DEFAULT_OPTIONS"),Te=(()=>{let n=class n extends Si{get hideToggle(){return this._hideToggle||this.accordion&&this.accordion.hideToggle}set hideToggle(e){this._hideToggle=e}get togglePosition(){return this._togglePosition||this.accordion&&this.accordion.togglePosition}set togglePosition(e){this._togglePosition=e}constructor(e,i,a,c,g,v,T){super(e,i,a),this._viewContainerRef=c,this._animationMode=v,this._hideToggle=!1,this.afterExpand=new D,this.afterCollapse=new D,this._inputChanges=new W,this._headerId=`mat-expansion-panel-header-${zn++}`,this._bodyAnimationDone=new W,this.accordion=e,this._document=g,this._bodyAnimationDone.pipe(dt((C,f)=>C.fromState===f.fromState&&C.toState===f.toState)).subscribe(C=>{C.fromState!=="void"&&(C.toState==="expanded"?this.afterExpand.emit():C.toState==="collapsed"&&this.afterCollapse.emit())}),T&&(this.hideToggle=T.hideToggle)}_hasSpacing(){return this.accordion?this.expanded&&this.accordion.displayMode==="default":!1}_getExpandedState(){return this.expanded?"expanded":"collapsed"}toggle(){this.expanded=!this.expanded}close(){this.expanded=!1}open(){this.expanded=!0}ngAfterContentInit(){this._lazyContent&&this._lazyContent._expansionPanel===this&&this.opened.pipe(Ke(null),fe(()=>this.expanded&&!this._portal),ct(1)).subscribe(()=>{this._portal=new zt(this._lazyContent._template,this._viewContainerRef)})}ngOnChanges(e){this._inputChanges.next(e)}ngOnDestroy(){super.ngOnDestroy(),this._bodyAnimationDone.complete(),this._inputChanges.complete()}_containsFocus(){if(this._body){let e=this._document.activeElement,i=this._body.nativeElement;return e===i||i.contains(e)}return!1}};n.\u0275fac=function(i){return new(i||n)(x(at,12),x(xe),x(Oe),x(ft),x(Tt),x(Be,8),x(Mi,8))},n.\u0275cmp=k({type:n,selectors:[["mat-expansion-panel"]],contentQueries:function(i,a,c){if(i&1&&qe(c,On,5),i&2){let g;ie(g=ne())&&(a._lazyContent=g.first)}},viewQuery:function(i,a){if(i&1&&Pe(Dn,5),i&2){let c;ie(c=ne())&&(a._body=c.first)}},hostAttrs:[1,"mat-expansion-panel"],hostVars:6,hostBindings:function(i,a){i&2&&ve("mat-expanded",a.expanded)("_mat-animation-noopable",a._animationMode==="NoopAnimations")("mat-expansion-panel-spacing",a._hasSpacing())},inputs:{hideToggle:[z.HasDecoratorInputTransform,"hideToggle","hideToggle",q],togglePosition:"togglePosition"},outputs:{afterExpand:"afterExpand",afterCollapse:"afterCollapse"},exportAs:["matExpansionPanel"],standalone:!0,features:[N([{provide:at,useValue:void 0},{provide:Fi,useExisting:n}]),B,P,De,I],ngContentSelectors:In,decls:7,vars:4,consts:[["role","region",1,"mat-expansion-panel-content",3,"id"],["body",""],[1,"mat-expansion-panel-body"],[3,"cdkPortalOutlet"]],template:function(i,a){i&1&&(Qe(Pn),Y(0),r(1,"div",0,1),b("@bodyExpansion.done",function(g){return a._bodyAnimationDone.next(g)}),r(3,"div",2),Y(4,1),_(5,kn,0,0,"ng-template",3),l(),Y(6,2),l()),i&2&&(d(),p("@bodyExpansion",a._getExpandedState())("id",a.id),Ye("aria-labelledby",a._headerId),d(4),p("cdkPortalOutlet",a._portal))},dependencies:[Nt],styles:['.mat-expansion-panel{box-sizing:content-box;display:block;margin:0;overflow:hidden;transition:margin 225ms cubic-bezier(0.4, 0, 0.2, 1),box-shadow 280ms cubic-bezier(0.4, 0, 0.2, 1);position:relative;background:var(--mat-expansion-container-background-color);color:var(--mat-expansion-container-text-color);border-radius:var(--mat-expansion-container-shape)}.mat-expansion-panel:not([class*=mat-elevation-z]){box-shadow:0px 3px 1px -2px rgba(0, 0, 0, 0.2), 0px 2px 2px 0px rgba(0, 0, 0, 0.14), 0px 1px 5px 0px rgba(0, 0, 0, 0.12)}.mat-accordion .mat-expansion-panel:not(.mat-expanded),.mat-accordion .mat-expansion-panel:not(.mat-expansion-panel-spacing){border-radius:0}.mat-accordion .mat-expansion-panel:first-of-type{border-top-right-radius:var(--mat-expansion-container-shape);border-top-left-radius:var(--mat-expansion-container-shape)}.mat-accordion .mat-expansion-panel:last-of-type{border-bottom-right-radius:var(--mat-expansion-container-shape);border-bottom-left-radius:var(--mat-expansion-container-shape)}.cdk-high-contrast-active .mat-expansion-panel{outline:solid 1px}.mat-expansion-panel.ng-animate-disabled,.ng-animate-disabled .mat-expansion-panel,.mat-expansion-panel._mat-animation-noopable{transition:none}.mat-expansion-panel-content{display:flex;flex-direction:column;overflow:visible;font-family:var(--mat-expansion-container-text-font);font-size:var(--mat-expansion-container-text-size);font-weight:var(--mat-expansion-container-text-weight);line-height:var(--mat-expansion-container-text-line-height);letter-spacing:var(--mat-expansion-container-text-tracking)}.mat-expansion-panel-content[style*="visibility: hidden"] *{visibility:hidden !important}.mat-expansion-panel-body{padding:0 24px 16px}.mat-expansion-panel-spacing{margin:16px 0}.mat-accordion>.mat-expansion-panel-spacing:first-child,.mat-accordion>*:first-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-top:0}.mat-accordion>.mat-expansion-panel-spacing:last-child,.mat-accordion>*:last-child:not(.mat-expansion-panel) .mat-expansion-panel-spacing{margin-bottom:0}.mat-action-row{border-top-style:solid;border-top-width:1px;display:flex;flex-direction:row;justify-content:flex-end;padding:16px 8px 16px 24px;border-top-color:var(--mat-expansion-actions-divider-color)}.mat-action-row .mat-button-base,.mat-action-row .mat-mdc-button-base{margin-left:8px}[dir=rtl] .mat-action-row .mat-button-base,[dir=rtl] .mat-action-row .mat-mdc-button-base{margin-left:0;margin-right:8px}'],encapsulation:2,data:{animation:[Ei.bodyExpansion]},changeDetection:0});let t=n;return t})();var Se=(()=>{let n=class n{constructor(e,i,a,c,g,v,T){this.panel=e,this._element=i,this._focusMonitor=a,this._changeDetectorRef=c,this._animationMode=v,this._parentChangeSubscription=Ee.EMPTY,this.tabIndex=0;let C=e.accordion?e.accordion._stateChanges.pipe(fe(f=>!!(f.hideToggle||f.togglePosition))):st;this.tabIndex=parseInt(T||"")||0,this._parentChangeSubscription=mt(e.opened,e.closed,C,e._inputChanges.pipe(fe(f=>!!(f.hideToggle||f.disabled||f.togglePosition)))).subscribe(()=>this._changeDetectorRef.markForCheck()),e.closed.pipe(fe(()=>e._containsFocus())).subscribe(()=>a.focusVia(i,"program")),g&&(this.expandedHeight=g.expandedHeight,this.collapsedHeight=g.collapsedHeight)}get disabled(){return this.panel.disabled}_toggle(){this.disabled||this.panel.toggle()}_isExpanded(){return this.panel.expanded}_getExpandedState(){return this.panel._getExpandedState()}_getPanelId(){return this.panel.id}_getTogglePosition(){return this.panel.togglePosition}_showToggle(){return!this.panel.hideToggle&&!this.panel.disabled}_getHeaderHeight(){let e=this._isExpanded();return e&&this.expandedHeight?this.expandedHeight:!e&&this.collapsedHeight?this.collapsedHeight:null}_keydown(e){switch(e.keyCode){case 32:case 13:Mt(e)||(e.preventDefault(),this._toggle());break;default:this.panel.accordion&&this.panel.accordion._handleHeaderKeydown(e);return}}focus(e,i){e?this._focusMonitor.focusVia(this._element,e,i):this._element.nativeElement.focus(i)}ngAfterViewInit(){this._focusMonitor.monitor(this._element).subscribe(e=>{e&&this.panel.accordion&&this.panel.accordion._handleHeaderFocus(this)})}ngOnDestroy(){this._parentChangeSubscription.unsubscribe(),this._focusMonitor.stopMonitoring(this._element)}};n.\u0275fac=function(i){return new(i||n)(x(Te,1),x(gt),x(kt),x(xe),x(Mi,8),x(Be,8),_t("tabindex"))},n.\u0275cmp=k({type:n,selectors:[["mat-expansion-panel-header"]],hostAttrs:["role","button",1,"mat-expansion-panel-header","mat-focus-indicator"],hostVars:15,hostBindings:function(i,a){i&1&&b("click",function(){return a._toggle()})("keydown",function(g){return a._keydown(g)}),i&2&&(Ye("id",a.panel._headerId)("tabindex",a.disabled?-1:a.tabIndex)("aria-controls",a._getPanelId())("aria-expanded",a._isExpanded())("aria-disabled",a.panel.disabled),xt("height",a._getHeaderHeight()),ve("mat-expanded",a._isExpanded())("mat-expansion-toggle-indicator-after",a._getTogglePosition()==="after")("mat-expansion-toggle-indicator-before",a._getTogglePosition()==="before")("_mat-animation-noopable",a._animationMode==="NoopAnimations"))},inputs:{expandedHeight:"expandedHeight",collapsedHeight:"collapsedHeight",tabIndex:[z.HasDecoratorInputTransform,"tabIndex","tabIndex",e=>e==null?0:bt(e)]},standalone:!0,features:[B,I],ngContentSelectors:Rn,decls:5,vars:3,consts:[[1,"mat-content"],["class","mat-expansion-indicator"],[1,"mat-expansion-indicator"]],template:function(i,a){i&1&&(Qe(An),r(0,"span",0),Y(1),Y(2,1),Y(3,2),l(),_(4,Vn,1,1,"span",1)),i&2&&(ve("mat-content-hide-toggle",!a._showToggle()),d(4),y(4,a._showToggle()?4:-1))},styles:['.mat-expansion-panel-header{display:flex;flex-direction:row;align-items:center;padding:0 24px;border-radius:inherit;transition:height 225ms cubic-bezier(0.4, 0, 0.2, 1);height:var(--mat-expansion-header-collapsed-state-height);font-family:var(--mat-expansion-header-text-font);font-size:var(--mat-expansion-header-text-size);font-weight:var(--mat-expansion-header-text-weight);line-height:var(--mat-expansion-header-text-line-height);letter-spacing:var(--mat-expansion-header-text-tracking)}.mat-expansion-panel-header.mat-expanded{height:var(--mat-expansion-header-expanded-state-height)}.mat-expansion-panel-header[aria-disabled=true]{color:var(--mat-expansion-header-disabled-state-text-color)}.mat-expansion-panel-header:not([aria-disabled=true]){cursor:pointer}.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-header-hover-state-layer-color)}@media(hover: none){.mat-expansion-panel:not(.mat-expanded) .mat-expansion-panel-header:not([aria-disabled=true]):hover{background:var(--mat-expansion-container-background-color)}}.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-keyboard-focused,.mat-expansion-panel .mat-expansion-panel-header:not([aria-disabled=true]).cdk-program-focused{background:var(--mat-expansion-header-focus-state-layer-color)}.mat-expansion-panel-header._mat-animation-noopable{transition:none}.mat-expansion-panel-header:focus,.mat-expansion-panel-header:hover{outline:none}.mat-expansion-panel-header.mat-expanded:focus,.mat-expansion-panel-header.mat-expanded:hover{background:inherit}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before{flex-direction:row-reverse}.mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 16px 0 0}[dir=rtl] .mat-expansion-panel-header.mat-expansion-toggle-indicator-before .mat-expansion-indicator{margin:0 0 0 16px}.mat-content{display:flex;flex:1;flex-direction:row;overflow:hidden}.mat-content.mat-content-hide-toggle{margin-right:8px}[dir=rtl] .mat-content.mat-content-hide-toggle{margin-right:0;margin-left:8px}.mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-left:24px;margin-right:0}[dir=rtl] .mat-expansion-toggle-indicator-before .mat-content.mat-content-hide-toggle{margin-right:24px;margin-left:0}.mat-expansion-panel-header-title{color:var(--mat-expansion-header-text-color)}.mat-expansion-panel-header-title,.mat-expansion-panel-header-description{display:flex;flex-grow:1;flex-basis:0;margin-right:16px;align-items:center}[dir=rtl] .mat-expansion-panel-header-title,[dir=rtl] .mat-expansion-panel-header-description{margin-right:0;margin-left:16px}.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-title,.mat-expansion-panel-header[aria-disabled=true] .mat-expansion-panel-header-description{color:inherit}.mat-expansion-panel-header-description{flex-grow:2;color:var(--mat-expansion-header-description-color)}.mat-expansion-indicator::after{border-style:solid;border-width:0 2px 2px 0;content:"";display:inline-block;padding:3px;transform:rotate(45deg);vertical-align:middle;color:var(--mat-expansion-header-indicator-color)}.cdk-high-contrast-active .mat-expansion-panel-content{border-top:1px solid;border-top-left-radius:0;border-top-right-radius:0}'],encapsulation:2,data:{animation:[Ei.indicatorRotate]},changeDetection:0});let t=n;return t})();var Ge=(()=>{let n=class n{};n.\u0275fac=function(i){return new(i||n)},n.\u0275dir=K({type:n,selectors:[["mat-panel-title"]],hostAttrs:[1,"mat-expansion-panel-header-title"],standalone:!0});let t=n;return t})(),Le=(()=>{let n=class n extends Ti{constructor(){super(...arguments),this._ownHeaders=new vt,this.hideToggle=!1,this.displayMode="default",this.togglePosition="after"}ngAfterContentInit(){this._headers.changes.pipe(Ke(this._headers)).subscribe(e=>{this._ownHeaders.reset(e.filter(i=>i.panel.accordion===this)),this._ownHeaders.notifyOnChanges()}),this._keyManager=new Dt(this._ownHeaders).withWrap().withHomeAndEnd()}_handleHeaderKeydown(e){this._keyManager.onKeydown(e)}_handleHeaderFocus(e){this._keyManager.updateActiveItem(e)}ngOnDestroy(){super.ngOnDestroy(),this._keyManager?.destroy(),this._ownHeaders.destroy()}};n.\u0275fac=(()=>{let e;return function(a){return(e||(e=ht(n)))(a||n)}})(),n.\u0275dir=K({type:n,selectors:[["mat-accordion"]],contentQueries:function(i,a,c){if(i&1&&qe(c,Se,5),i&2){let g;ie(g=ne())&&(a._headers=g)}},hostAttrs:[1,"mat-accordion"],hostVars:2,hostBindings:function(i,a){i&2&&ve("mat-accordion-multi",a.multi)},inputs:{hideToggle:[z.HasDecoratorInputTransform,"hideToggle","hideToggle",q],displayMode:"displayMode",togglePosition:"togglePosition"},exportAs:["matAccordion"],standalone:!0,features:[N([{provide:at,useExisting:n}]),B,P]});let t=n;return t})(),Di=(()=>{let n=class n{};n.\u0275fac=function(i){return new(i||n)},n.\u0275mod=Me({type:n}),n.\u0275inj=Fe({imports:[Pt,yi,Ut]});let t=n;return t})();var ye=we(it());var ki=(()=>{let n=class n extends O{constructor(e,i,a,c){super(),this.impiegatoService=e,this.fb=i,this.dialog=a,this.data=c,this.fileUploadForm=this.fb.group({uploadFile:["",[We.required]]}),this.giustificativofileUploadForm=this.fb.group({uploadFile:["",[We.required]],comment:[""]}),this.idTimesheet=c.timesheet}AllegaGius(){let e=new FormData;e.append("file",this.giustificativofileUploadForm.get("uploadFile")?.value),this.subs.sink=this.impiegatoService.submitGiustificativoTimesheet(this.idTimesheet,e).subscribe({next:i=>{ye.default.fire("Giustificiativo Inviato!","\xE8 stato allegato un giustificativo ","success")},error:i=>{ye.default.fire("Errore Generico","Si prega di contattare l'amministratore ","error")},complete:()=>{this.dialog.closeAll(),console.log("File upload complete")}})}AllegaFile(){let e=new FormData;e.append("file",this.fileUploadForm.get("uploadFile")?.value),this.subs.sink=this.impiegatoService.submitAllegatoTimesheet(this.idTimesheet,e,this.fileUploadForm.get("comment")?.value).subscribe({next:i=>{ye.default.fire("File Inviata!","\xE8 stato allegato un file con successo ","success")},error:i=>{ye.default.fire("Errore Generico","Si prega di contattare l'amministratore ","error")},complete:()=>{this.dialog.closeAll(),console.log("File upload complete")}})}ngOnInit(){}};n.\u0275fac=function(i){return new(i||n)(x(G),x(H),x(Ue),x(ei))},n.\u0275cmp=k({type:n,selectors:[["app-dialog-for-attach-files"]],standalone:!0,features:[P,I],decls:35,vars:4,consts:[[1,"container"],[1,"row"],[1,"card"],[1,"header"],[1,"body"],[1,"example-container"],[3,"formGroup"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12","mb-3"],["formControlName","uploadFile"],["mat-flat-button","","color","accent","type","submit",2,"width","100%","height","5vh",3,"disabled","click"],[1,"row","mb-2"],["matInput","","formControlName","comment",1,"form-control"],["mat-flat-button","","color","primary","type","submit",2,"width","100%","height","5vh",3,"disabled","click"]],template:function(i,a){i&1&&(r(0,"div",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"h2"),s(5,"Giustificativi"),l()(),r(6,"div",4)(7,"div",5)(8,"form",6)(9,"div",1)(10,"div",7)(11,"mat-label"),s(12,"Carica File"),l(),S(13,"app-file-upload",8),l()()()()(),r(14,"button",9),b("click",function(){return a.AllegaGius()}),s(15," Allega Giustificativo "),l()()(),r(16,"div",1)(17,"div",2)(18,"div",3)(19,"h2"),s(20,"Allegato"),l()(),r(21,"div",4)(22,"div",5)(23,"form",6)(24,"div",10)(25,"mat-label"),s(26,"Commento"),l(),S(27,"textarea",11),l(),r(28,"div",1)(29,"div",7)(30,"mat-label"),s(31,"Carica File"),l(),S(32,"app-file-upload",8),l()()()()(),r(33,"button",12),b("click",function(){return a.AllegaFile()}),s(34," Allega File "),l()()()()),i&2&&(d(8),p("formGroup",a.giustificativofileUploadForm),d(6),p("disabled",!a.giustificativofileUploadForm.valid),d(9),p("formGroup",a.fileUploadForm),d(10),p("disabled",!a.fileUploadForm.valid))},dependencies:[ue,ce,de,$,re,U,j,ae,se,me,ze]});let t=n;return t})();function jn(t,n){if(t&1){let o=w();r(0,"div",7),S(1,"div",8)(2,"div",9)(3,"div",10),r(4,"div",11)(5,"mat-accordion")(6,"mat-expansion-panel",12),b("opened",function(){u(o);let i=m();return h(i.panelOpenState=!0)})("closed",function(){u(o);let i=m();return h(i.panelOpenState=!1)}),r(7,"mat-expansion-panel-header")(8,"mat-panel-title"),s(9," Ore permesso e ferie "),l()(),r(10,"p"),s(11),l(),r(12,"p"),s(13),l(),r(14,"p"),s(15),l(),r(16,"p"),s(17),l()()()()()}if(t&2){let o=m();d(11),E("Ore permesso anno in corso : ",o.authService.currentUserValue.anagraficaLavorativa[0].giorniPermesso,""),d(2),E("Ore ferie anno in corso : ",o.authService.currentUserValue.anagraficaLavorativa[0].giorniFerie,""),d(2),E("Ore permesso rimanenti : ",o.rimanezaPermesso,""),d(2),E("Ore ferie anno rimanenti : ",o.rimanezaFerie,"")}}function Hn(t,n){return this.columns}function $n(t,n){t&1&&(r(0,"div",29),s(1,"Attesa Revisione"),l())}function Gn(t,n){t&1&&(r(0,"div",30),s(1,"Approvato"),l())}function Ln(t,n){t&1&&(r(0,"div",31),s(1,"Rifiutato"),l())}function Kn(t,n){t&1&&(r(0,"div",32),s(1,"Non inviato"),l())}function Bn(t,n){if(t&1&&_(0,$n,2,0)(1,Gn,2,0)(2,Ln,2,0)(3,Kn,2,0),t&2){let o=n.value,e;y(0,(e=o)==="SENDED"?0:e==="APPROVED"?1:e==="REJECTED"?2:e==="CREATED"?3:-1)}}function Yn(t,n){if(t&1&&(r(0,"ngx-datatable-column",28),_(1,Bn,4,1,"ng-template",27),l()),t&2){let o=m().$implicit;p("name",o.name)("prop",o.prop)("sortable",!1)("flexGrow",3)}}function Qn(t,n){t&1&&(r(0,"div",29),s(1,"Attesa di approvazione"),l())}function qn(t,n){}function Jn(t,n){t&1&&(r(0,"div",31),s(1,"Attesa Revisione utente"),l())}function Xn(t,n){if(t&1&&_(0,Qn,2,0)(1,qn,0,0)(2,Jn,2,0),t&2){let o=m().row,e;y(0,(e=o.stato)==="SENDED"?0:e==="CREATED"?1:e==="REJECTED"?2:-1)}}function Wn(t,n){if(t&1){let o=w();r(0,"button",34),b("click",function(){u(o);let i=m(),a=i.value,c=i.row,g=m(2).$implicit,v=m(3);return h(v.downloadFile(a,g.prop,c))}),s(1,"Scarica"),l()}}function Zn(t,n){t&1&&(r(0,"div",30),s(1,"Non Allegato"),l())}function eo(t,n){if(t&1&&_(0,Xn,3,1)(1,Wn,2,0)(2,Zn,2,0),t&2){let o=n.value,e=n.row;y(0,e.stato!="APPROVED"?0:o!=""?1:2)}}function to(t,n){if(t&1&&(r(0,"ngx-datatable-column",33),_(1,eo,3,1,"ng-template",27),l()),t&2){let o=m().$implicit;p("prop",o.prop)("name",o.name)("flexGrow",3)}}function io(t,n){if(t&1&&S(0,"ngx-datatable-column",33),t&2){let o=m().$implicit;p("prop",o.prop)("name",o.name)("flexGrow",3)}}function no(t,n){if(t&1&&_(0,Yn,2,4,"ngx-datatable-column",28)(1,to,2,3)(2,io,1,3),t&2){let o=n.$implicit;y(0,o.prop==="stato"?0:o.prop!="periodo"?1:2)}}function oo(t,n){if(t&1){let o=w();r(0,"span")(1,"button",35),b("click",function(){let a=u(o).row,c=m(3);return h(c.openTimesheet(a.id))}),r(2,"i",36),s(3,"remove_red_eye"),l()(),r(4,"button",37)(5,"i",38),b("click",function(){let a=u(o).row,c=m(3);return h(c.openModalForAttachFile(a.id))}),s(6,"attach_file"),l()(),r(7,"button",37)(8,"i",36),s(9,"delete"),l()()()}}function ao(t,n){if(t&1){let o=w();r(0,"div",4)(1,"div",14)(2,"div",15)(3,"ul",16)(4,"li",17)(5,"h2"),s(6,"Timesheets"),l()(),r(7,"li",18)(8,"label",19)(9,"i",20),s(10,"search"),l()(),r(11,"input",21),b("keyup",function(i){u(o);let a=m(2);return h(a.filterDatatable(i))}),l()()(),r(12,"ul",22)(13,"li")(14,"button",23),s(15," EX "),l()()()(),r(16,"ngx-datatable",24,25),ee(18,no,3,1,null,null,Hn,!0),r(20,"ngx-datatable-column",26),_(21,oo,10,0,"ng-template",27),l()()()()}if(t&2){let o=m(2);d(16),p("rows",o.data)("columns",o.columns)("sortType",o.SortType.multi)("columnMode","force")("headerHeight",50)("footerHeight",50)("rowHeight",60)("limit",10),d(2),te(o.columns),d(2),p("sortable",!1)("flexGrow",1)}}function ro(t,n){if(t&1){let o=w();r(0,"div",51),S(1,"div",10),r(2,"div",49)(3,"div",39)(4,"div",40)(5,"h2"),s(6,"Sezione Giustificativi"),l()(),r(7,"div",52)(8,"table",53)(9,"tbody")(10,"tr")(11,"td",54)(12,"strong"),s(13,"Modello Auto :"),l()(),r(14,"td"),s(15),l()(),r(16,"tr")(17,"td",54)(18,"strong"),s(19,"Rimborso Km :"),l()(),r(20,"td"),s(21),l()(),r(22,"tr")(23,"td",54)(24,"strong"),s(25,"Totale Km Percorsi :"),l()(),r(26,"td"),s(27),l()(),r(28,"tr")(29,"td",54)(30,"strong"),s(31,"Giustificativi :"),l()(),r(32,"td")(33,"input",55),b("ngModelChange",function(i){u(o);let a=m(3);return h(a.ngiustificativi=i)})("change",function(i){u(o);let a=m(3);return h(a.updateNgiustificativi(i))}),l()()(),r(34,"tr")(35,"td",54)(36,"strong"),s(37,"Totale Rimborso :"),l()(),r(38,"td"),s(39),l()()()()()()(),r(40,"div",10)(41,"div",4)(42,"div",39)(43,"div",40)(44,"h2"),s(45,"Giustificativi"),l()(),r(46,"div",56)(47,"div",57)(48,"form",58)(49,"div",4)(50,"div",59)(51,"mat-label"),s(52,"Carica File"),l(),S(53,"app-file-upload",60),l()()()()()(),r(54,"button",61),b("click",function(){u(o);let i=m(3);return h(i.AllegaGius())}),s(55," Allega Giustificativo "),l()()()()}if(t&2){let o=m(3);d(15),Q(o.authService.currentUserValue.modello_auto),d(6),E("",o.authService.currentUserValue.rimborsoKm," \u20AC"),d(6),Q(o.totKm),d(6),p("ngModel",o.ngiustificativi),d(6),E("",o.totRimborsoKm," \u20AC"),d(9),p("formGroup",o.fileUploadForm),d(6),p("disabled",!1)}}function lo(t,n){if(t&1){let o=w();r(0,"button",62),b("click",function(){u(o);let i=m(3);return h(i.onSubmitTimesheet())}),s(1," Invia Richiesta autorizzazione "),l()}if(t&2){let o=m(3);p("disabled",!o.checkTimesheetIsValid())}}function so(t,n){if(t&1){let o=w();r(0,"div",39)(1,"div",40)(2,"div",3)(3,"div",4)(4,"div",8)(5,"button",41),b("click",function(){u(o);let i=m(2);return h(i.back())}),r(6,"div",42)(7,"i",36),s(8,"undo"),l(),r(9,"span",43),s(10," Torna alla ricerca"),l()()()(),r(11,"div",9)(12,"h3"),s(13,"Scheda TImesheet"),l()(),r(14,"div",8)(15,"mat-slide-toggle",44),b("change",function(i){u(o);let a=m(2);return h(a.setAutomaticSave(i))}),s(16,"Salvataggio automatico"),l(),r(17,"mat-slide-toggle",44),b("change",function(i){u(o);let a=m(2);return h(a.setSlide(i))}),s(18,"Abilita margini cella"),l()()()()(),r(19,"div",45)(20,"div",46)(21,"app-timesheet-dettaglio",47),b("oreFerie",function(i){u(o);let a=m(2);return h(a.minusOreFerie(i))})("orePermesso",function(i){u(o);let a=m(2);return h(a.minusOrePermesso(i))})("myEvent",function(i){u(o);let a=m(2);return h(a.getKmPercorsiFromChild(i))})("timesheetEvent",function(i){u(o);let a=m(2);return h(a.UpdateFieldTimesheet(i))})("myEvent2",function(i){u(o);let a=m(2);return h(a.minusKmPercorsiFromChild(i))}),l()()()(),r(22,"div",4),_(23,ro,56,7,"div",48),l(),r(24,"div",4),S(25,"div",10),r(26,"div",49),_(27,lo,2,1,"button",50),l(),S(28,"div",10),l()}if(t&2){let o=m(2);d(21),p("rimanenzaFerie",o.rimanezaFerie)("rimanenzaPermesso",o.rimanezaPermesso)("disableMargin",o.checkedFR)("timesheet",o.timesheet),d(2),y(23,o.authService.currentUserValue.rimborso&&o.timesheet!=null&&!o.loading?23:-1),d(4),y(27,o.timesheet!=null?27:-1)}}function mo(t,n){if(t&1&&_(0,ao,22,10,"div",13)(1,so,29,6),t&2){let o=m();y(0,o.timesheet==null?0:1)}}function co(t,n){t&1&&(r(0,"div",3)(1,"div",4),S(2,"div",63),r(3,"div",64)(4,"div",39)(5,"div",65)(6,"div",66)(7,"div",14),S(8,"mat-spinner"),l()()()()(),S(9,"div",63),l()())}var po=()=>["Home"],Pi=(()=>{let n=class n extends O{constructor(e,i,a,c,g,v){super(),this.impiegatoService=e,this.fileSystemService=i,this.authService=a,this.snackBar=c,this.dialogModel=g,this.fb=v,this.data=[],this.filteredData=[],this.columns=[{name:"Periodo Timesheet",prop:"periodo"},{name:"Stato",prop:"stato"},{name:"Busta Paga",prop:"idBustaPaga"},{name:"Giustificativo",prop:"idGiustificativo"},{name:"Allegato",prop:"idallegato"}],this.SortType=Jt,this.JSON=JSON,this.loading=!1,this.timesheet=null,this.rimanezaPermesso=0,this.rimanezaFerie=0,this.totKm=0,this.automaticSave=!1,this.totRimborsoKm=0,this.checkedFR=!1,this.ngiustificativi=0,this.panelOpenState=!0,this.fileUploadForm=v.group({uploadFile:[""]})}ngOnInit(){this.loading=!0,this.rimanezaPermesso=this.authService.currentUserValue.anagraficaLavorativa[0].giorniPermesso,this.rimanezaFerie=this.authService.currentUserValue.anagraficaLavorativa[0].giorniFerie,this.loadTable()}loadTable(){this.subs.sink=this.impiegatoService.getAllTimesheetList().subscribe({next:e=>{this.data=e,this.filteredData=this.data,this.loading=!1}})}filterDatatable(e){let i=e.target.value.toLowerCase(),a=this.columns.length;i!=""?this.data=this.filteredData.filter(function(c){for(let g=0;g<a;g++)if(c.periodo.toString().toLowerCase().indexOf(i)!==-1||!i)return!0;return!1}):this.data=this.filteredData,this.table.offset=0}updateNgiustificativi(e){this.subs.sink=this.impiegatoService.submitNgiustificativi(Number(e.target.value),this.timesheet.id).subscribe({next:i=>{J("accent","Giustificativi aggiornati con successo","top","center",this.snackBar)}})}UpdateFieldTimesheet(e){this.timesheet.datiTimesheet[e.index][e.field]=e.dato,this.automaticSave&&(this.subs.sink=this.impiegatoService.submitDatoTImesheet(this.timesheet.datiTimesheet[e.index]).subscribe({next:i=>{console.log(i)}}))}setAutomaticSave(e){this.automaticSave=e.checked}setSlide(e){this.checkedFR=e.checked}getKmPercorsiFromChild(e){this.totKm+=e.km,this.totRimborsoKm+=e.km*this.authService.currentUserValue.rimborsoKm}minusKmPercorsiFromChild(e){this.totKm-=e.km,this.totRimborsoKm-=e.km*this.authService.currentUserValue.rimborsoKm}minusOrePermesso(e){this.rimanezaPermesso=e.action}minusOreFerie(e){this.rimanezaFerie=e.action}openTimesheet(e){this.loading=!0,this.subs.sink=this.impiegatoService.submitPeriodoTimesheet(e).subscribe({next:i=>{this.timesheet=i,this.loading=!1},error:i=>{console.log("CIIIIAOOOOO"),this.loading=!1}})}onSubmitTimesheet(){this.loading=!0,this.subs.sink=this.impiegatoService.submitTimesheet(this.timesheet).subscribe({next:e=>{L.default.fire("Timesheet inviato con successo!","timesheet spedito ed in attesa di revisione, le arriver\xE0 una mail contenente in dettaglio per la tracciabilit\xE0","success"),this.timesheet=null,this.loadTable(),this.loading=!1},error:e=>{L.default.fire("Errore generico!","Riprovare piu tardi","error"),this.loading=!1}})}checkTimesheetIsValid(){let e=!0;return this.timesheet.datiTimesheet.forEach(i=>{let a=0;Object.keys(i).forEach(c=>{["sede","clienteOre","straordinari","ferie","permessi","altro"].includes(c)&&(c==="altro"?a+=i[c]!=""?this.authService.currentUserValue.oreLavorative:0:a+=Number(i[c])||0)}),a<this.authService.currentUserValue.oreLavorative&&(e=!1)}),e}back(){this.timesheet=null,this.loadTable()}AllegaGius(){let e=new FormData;e.append("file",this.fileUploadForm.get("uploadFile")?.value),this.loading=!0,this.subs.sink=this.impiegatoService.submitGiustificativoTimesheet(this.timesheet.id,e).subscribe({next:i=>{L.default.fire("Giustificativo Allegato!","\xE8 stato allegato un giustificativo con successo","success")},error:i=>{L.default.fire("Errore Generico","Si prega di contattare l'amministratore ","error")},complete:()=>{this.loading=!1,console.log("File upload complete")}})}openModalForAttachFile(e){this.dialogModel.open(ki,{width:"1280px",disableClose:!1,data:{timesheet:e}})}downloadFile(e,i,a){switch(i){case"idGiustificativo":this.subs.sink=this.fileSystemService.downloadGiustifivativi(e).subscribe({next:c=>{let g=window.URL.createObjectURL(c),v=document.createElement("a");v.href=g,v.download=`giustificativo_${e}_${a.periodo.split(" ").join("")}`,v.click(),window.URL.revokeObjectURL(g)},error:c=>{L.default.fire("Errore Generico","Si prega di contattare l'amministratore ","error")},complete:()=>{}});break;case"idBustaPaga":this.subs.sink=this.fileSystemService.downloadBustePaga(e).subscribe({next:c=>{let g=window.URL.createObjectURL(c),v=document.createElement("a");v.href=g,v.download=`bustaPaga_${e}_${a.periodo.split(" ").join("")}`,v.click(),window.URL.revokeObjectURL(g)},error:c=>{L.default.fire("Errore Generico","Si prega di contattare l'amministratore ","error")},complete:()=>{}});break;default:this.subs.sink=this.fileSystemService.downloadAllegato(e).subscribe({next:c=>{let g=window.URL.createObjectURL(c),v=document.createElement("a");v.href=g,v.download=`Allegato_${e}_${a.periodo.split(" ").join("")}`,v.click(),window.URL.revokeObjectURL(g)},error:c=>{L.default.fire("Errore Generico","Si prega di contattare l'amministratore ","error")},complete:()=>{}});break}}};n.\u0275fac=function(i){return new(i||n)(x(G),x(ti),x(oe),x(he),x(Ue),x(H))},n.\u0275cmp=k({type:n,selectors:[["app-riepilogo-timesheet"]],viewQuery:function(i,a){if(i&1&&Pe(Ne,5),i&2){let c;ie(c=ne())&&(a.table=c.first)}},inputs:{checks:"checks"},standalone:!0,features:[P,I],decls:10,vars:6,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[1,"container-fluid"],[1,"row"],[3,"title","items","active_item"],["class","row mb-3"],[1,"row","mb-3"],[1,"col-xl-4","col-lg-4","col-md-4"],[1,"col-xl-4","col-lg-4","col-md-4","col-sm-4","pt-2","align-center","align-content-center"],[1,"col-xl-2","col-lg-2","col-md-2"],[1,"col-xl-2","col-lg-2","col-md-2","align-center","justify-content-end"],[3,"opened","closed"],["class","row"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12"],[1,"ngxTableHeader"],[1,"header-buttons-left","ms-0","mb-0"],[1,"dropdown"],[1,"dropdown","m-l-20"],["for","search-input"],[1,"material-icons","search-icon"],["placeholder","Cerca Mese - anno","type","text",1,"browser-default","search-field",3,"keyup"],[1,"header-buttons"],["mat-mini-fab","","color","primary"],[1,"material",3,"rows","columns","sortType","columnMode","headerHeight","footerHeight","rowHeight","limit"],["table",""],["name","Azioni",3,"sortable","flexGrow"],["ngx-datatable-cell-template",""],[3,"name","prop","sortable","flexGrow"],[1,"badge","badge-solid-orange"],[1,"badge","badge-solid-green"],[1,"badge","badge-solid-red"],[1,"badge","badge-solid-purple"],[3,"prop","name","flexGrow"],["mat-button","","color","accent",3,"click"],[1,"btn","tblActnBtn","h-auto",3,"click"],[1,"material-icons"],[1,"btn","tblActnBtn","h-auto"],[1,"material-icons",3,"click"],[1,"card"],[1,"header"],["mat-raised-button","","color","primary",3,"click"],[1,"demo-google-material-icon"],[1,"icon-name"],[3,"change"],[1,"body",2,"width","100%"],[1,"container-fluid",2,"width","100%"],[3,"rimanenzaFerie","rimanenzaPermesso","disableMargin","timesheet","oreFerie","orePermesso","myEvent","timesheetEvent","myEvent2"],["class","row mt-5"],[1,"col-xl-8","col-lg-8","col-md-8","col-sm-8"],["mat-flat-button","","color","primary","style","width: 100%;height: 5vh","class","mb-5","type","submit",3,"disabled"],[1,"row","mt-5"],[1,"body","table-responsive"],[1,"table","custom-table"],[1,"large-cell"],["type","number",1,"inputHid",3,"ngModel","ngModelChange","change"],[1,"body"],[1,"example-container"],[3,"formGroup"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12","mb-3"],["formControlName","uploadFile"],["mat-flat-button","","color","accent","type","submit",2,"width","100%","height","5vh",3,"disabled","click"],["mat-flat-button","","color","primary","type","submit",1,"mb-5",2,"width","100%","height","5vh",3,"disabled","click"],[1,"col-xl-2","col-lg-2","col-md-2","col-sm-2"],[1,"col-xl-8","col-lg-8","col-md-8","col-sm-8","align-content-center","justify-content-center"],[1,"card-body"],[1,"row","align-center"]],template:function(i,a){i&1&&(r(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),S(5,"app-breadcrumb",5),l(),r(6,"div",4),_(7,jn,18,4,"div",6),l()()()(),_(8,mo,2,1)(9,co,10,0),l()),i&2&&(d(5),p("title","Riepilogo Timesheet")("items",R(5,po))("active_item","Gestione Timesheet"),d(2),y(7,a.timesheet!=null?7:-1),d(),y(8,a.loading?9:8))},dependencies:[pe,Rt,Zt,Ne,Wt,Xt,ce,je,$e,Re,$,re,U,le,j,ae,se,me,Ae,Ve,Le,Te,Se,Ge,de,ue]});let t=n;return t})();var rt=we(Ri());var _e=we(it());function uo(t,n){if(t&1){let o=w();r(0,"div",13),S(1,"div",14)(2,"div",15)(3,"div",10),r(4,"div",16)(5,"mat-accordion")(6,"mat-expansion-panel",17),b("opened",function(){u(o);let i=m();return h(i.panelOpenState=!0)})("closed",function(){u(o);let i=m();return h(i.panelOpenState=!1)}),r(7,"mat-expansion-panel-header")(8,"mat-panel-title"),s(9," Ore permesso e ferie "),l()(),r(10,"p"),s(11),l(),r(12,"p"),s(13),l(),r(14,"p"),s(15),l(),r(16,"p"),s(17),l()()()()()}if(t&2){let o=m();d(11),E("Ore permesso anno in corso : ",o.authService.currentUserValue.anagraficaLavorativa[0].giorniPermesso,""),d(2),E("Ore ferie anno in corso : ",o.authService.currentUserValue.anagraficaLavorativa[0].giorniFerie,""),d(2),E("Ore permesso rimanenti : ",o.rimanezaPermesso,""),d(2),E("Ore ferie anno rimanenti : ",o.rimanezaFerie,"")}}function ho(t,n){if(t&1){let o=w();r(0,"button",21),b("click",function(){u(o);let i=m(2);return h(i.back())}),r(1,"div",22)(2,"i",23),s(3,"undo"),l(),r(4,"span",24),s(5," Torna alla ricerca"),l()()()}}function _o(t,n){if(t&1){let o=w();r(0,"mat-slide-toggle",25),b("change",function(i){u(o);let a=m(2);return h(a.setAutomaticSave(i))}),s(1,"Salvataggio automatico"),l(),r(2,"mat-slide-toggle",25),b("change",function(i){u(o);let a=m(2);return h(a.setSlide(i))}),s(3,"Abilita margini cella"),l()}}function go(t,n){return this.options}function fo(t,n){if(t&1&&(r(0,"mat-option",38),s(1),l()),t&2){let o=n.$implicit;p("value",o.id),d(),E(" ",o.option," ")}}function xo(t,n){if(t&1&&(r(0,"h6"),s(1,"Seleziona Timesheet esistente"),l(),r(2,"mat-form-field",36)(3,"mat-label"),s(4,"Periodo"),l(),r(5,"mat-select",37)(6,"mat-option",38),s(7,"Seleziona Periodo"),l(),ee(8,fo,2,2,"mat-option",38,go,!0),l()()),t&2){let o=m(3);d(6),p("value"," "),d(2),te(o.options)}}function vo(t,n){if(t&1){let o=w();r(0,"div",26)(1,"div",27)(2,"form",28)(3,"div",4)(4,"div",29),_(5,xo,10,1),l()(),r(6,"div",4)(7,"div",29)(8,"h6"),s(9,"Seleziona nuovo periodo Timesheet"),l(),r(10,"mat-form-field",30)(11,"mat-label"),s(12,"Mese e anno"),l(),S(13,"input",31)(14,"mat-datepicker-toggle",32),r(15,"mat-datepicker",33,34),b("monthSelected",function(i){u(o);let a=Je(16),c=m(2);return h(c.setMonthAndYear(i,a))}),l()()()()(),r(17,"div",29)(18,"button",35),b("click",function(){u(o);let i=m(2);return h(i.onSubmit())}),s(19," Inoltra Periodo Timesheet "),l()()()()}if(t&2){let o=Je(16),e=m(2);d(2),p("formGroup",e.YearMonthSearch),d(3),y(5,e.options.length>0?5:-1),d(8),p("matDatepicker",o),d(),p("for",o),d(4),p("disabled",!e.YearMonthSearch.valid)}}function Co(t,n){if(t&1){let o=w();r(0,"div",39)(1,"div",40)(2,"app-timesheet-dettaglio",41),b("oreFerie",function(i){u(o);let a=m(2);return h(a.minusOreFerie(i))})("orePermesso",function(i){u(o);let a=m(2);return h(a.minusOrePermesso(i))})("myEvent",function(i){u(o);let a=m(2);return h(a.getKmPercorsiFromChild(i))})("timesheetEvent",function(i){u(o);let a=m(2);return h(a.UpdateFieldTimesheet(i))})("myEvent2",function(i){u(o);let a=m(2);return h(a.minusKmPercorsiFromChild(i))}),l()()()}if(t&2){let o=m(2);d(2),p("rimanenzaFerie",o.rimanezaFerie)("rimanenzaPermesso",o.rimanezaPermesso)("disableMargin",o.checkedFR)("timesheet",o.timesheet)}}function bo(t,n){if(t&1&&(r(0,"div",18)(1,"div",3)(2,"div",4)(3,"div",14),_(4,ho,6,0,"button",19),l(),r(5,"div",15)(6,"h3"),s(7),l()(),r(8,"div",14),_(9,_o,4,0),l()()()(),_(10,vo,20,5,"div",20)(11,Co,3,4)),t&2){let o=m();d(4),y(4,o.timesheet!=null?4:-1),d(3),Q(o.timesheet==null?"Seleziona Periodo Timesheet":"Scheda TImesheet"),d(2),y(9,o.timesheet!=null?9:-1),d(),y(10,o.timesheet==null?10:11)}}function To(t,n){t&1&&(r(0,"div",3)(1,"div",42),S(2,"div",10),r(3,"div",43),S(4,"mat-spinner"),l(),S(5,"div",10),l()())}function So(t,n){t&1&&(r(0,"div",4),S(1,"mat-spinner"),l())}function yo(t,n){if(t&1){let o=w();r(0,"div",4)(1,"div",8)(2,"div",18)(3,"h2"),s(4,"Giustificativi"),l()(),r(5,"div",26)(6,"div",50)(7,"form",28)(8,"div",4)(9,"div",51)(10,"mat-label"),s(11,"Carica File"),l(),S(12,"app-file-upload",52),l()()()()()(),r(13,"button",53),b("click",function(){u(o);let i=m(2);return h(i.caricaGiustificativi())}),s(14," Allega Giustificativo "),l()()}if(t&2){let o=m(2);d(7),p("formGroup",o.fileUploadForm),d(6),p("disabled",!o.YearMonthSearch.valid)}}function wo(t,n){if(t&1){let o=w();r(0,"div",44),S(1,"div",10),r(2,"div",11)(3,"div",8)(4,"div",18)(5,"h2"),s(6,"Sezione Giustificativi"),l()(),r(7,"div",45)(8,"table",46)(9,"tbody")(10,"tr")(11,"td",47)(12,"strong"),s(13,"Modello Auto :"),l()(),r(14,"td"),s(15),l()(),r(16,"tr")(17,"td",47)(18,"strong"),s(19,"Rimborso Km :"),l()(),r(20,"td"),s(21),l()(),r(22,"tr")(23,"td",47)(24,"strong"),s(25,"Totale Km Percorsi :"),l()(),r(26,"td"),s(27),l()(),r(28,"tr")(29,"td",47)(30,"strong"),s(31,"Giustificativi :"),l()(),r(32,"td")(33,"input",48),b("ngModelChange",function(i){u(o);let a=m();return h(a.ngiustificativi=i)})("change",function(i){u(o);let a=m();return h(a.updateNgiustificativi(i))}),l()()(),r(34,"tr")(35,"td",47)(36,"strong"),s(37,"Totale Rimborso :"),l()(),r(38,"td"),s(39),l()()()()()()(),r(40,"div",10),_(41,So,2,0,"div",49)(42,yo,15,2),l()()}if(t&2){let o=m();d(15),Q(o.authService.currentUserValue.modello_auto),d(6),E("",o.authService.currentUserValue.rimborsoKm," \u20AC"),d(6),Q(o.totKm),d(6),p("ngModel",o.ngiustificativi),d(6),E("",o.totRimborsoKm," \u20AC"),d(2),y(41,o.loading?41:42)}}function Eo(t,n){if(t&1){let o=w();r(0,"button",54),b("click",function(){u(o);let i=m();return h(i.onSubmitTimesheet())}),s(1," Invia Richiesta autorizzazione "),l()}if(t&2){let o=m();p("disabled",!o.checkTimesheetIsValid())}}var Ii=()=>["Home"],Fo=()=>({"margin-top":"5%"}),Mo=()=>({}),Vi=(()=>{let n=class n extends O{constructor(e,i,a,c){super(),this.fb=e,this.impiegatoService=i,this.authService=a,this.snackBar=c,this.timesheet=null,this.laoding=!1,this.JSON=JSON,this.checkedFR=!1,this.panelOpenState=!0,this.totKm=0,this.totRimborsoKm=0,this.automaticSave=!1,this.monthsInItalian=gi,this.ngiustificativi=0,this.rimanezaPermesso=0,this.rimanezaFerie=0,this.loading=!1,this.YearMonthSearch=this.createUntypeForm(),this.fileUploadForm=e.group({uploadFile:[""]}),this.options=[]}createUntypeForm(){return this.fb.group({yearMonth:["",[]],selectPeriod:[(0,rt.default)().locale("it")]})}setMonthAndYear(e,i){let a=this.YearMonthSearch.get("selectPeriod").value??(0,rt.default)();a.month(e.month()),a.year(e.year()),a.locale("it"),this.YearMonthSearch.get("selectPeriod").setValue(a),i.close()}loadOption(){this.subs.sink=this.impiegatoService.getAllTimesheetOptionList().subscribe({next:e=>{this.options=e}})}ngOnInit(){this.rimanezaPermesso=this.authService.currentUserValue.anagraficaLavorativa[0].giorniPermesso,this.rimanezaFerie=this.authService.currentUserValue.anagraficaLavorativa[0].giorniFerie,this.loadOption(),this.subs.sink=this.YearMonthSearch.get("yearMonth").valueChanges.subscribe(e=>{e!=" "?this.YearMonthSearch.controls.selectPeriod.disable():this.YearMonthSearch.controls.selectPeriod.enable()})}onSubmitTimesheet(){this.laoding=!0,this.subs.sink=this.impiegatoService.submitTimesheet(this.timesheet).subscribe({next:e=>{_e.default.fire("Timesheet inviato con successo!","timesheet spedito ed in attesa di revisione","success"),this.timesheet=null,this.loadOption(),this.laoding=!1},error:e=>{_e.default.fire("Errore generico!","Riprovare piu tardi","error"),this.laoding=!1}})}onSubmit(){if(this.laoding=!0,this.YearMonthSearch.get("yearMonth")?.value===" "||this.YearMonthSearch.get("yearMonth")?.value===""){let e=this.YearMonthSearch.get("selectPeriod").value,i=e.month()+1,a=e.year();console.log("Year:",a,"Month:",i),this.subs.sink=this.impiegatoService.submitYearMonthTimesheetSearch({year:a,month:i}).subscribe({next:c=>{this.timesheet=c,this.laoding=!1},error:c=>{_e.default.fire("Ops Qualcosa \xE8 andato storto","","error"),this.laoding=!1}})}else this.subs.sink=this.impiegatoService.submitPeriodoTimesheet(this.YearMonthSearch.get("yearMonth").value).subscribe({next:e=>{this.timesheet=e,this.laoding=!1},error:e=>{console.log("CIIIIAOOOOO"),this.laoding=!1}});this.rimanezaPermesso=this.authService.currentUserValue.anagraficaLavorativa[0].giorniPermesso,this.rimanezaFerie=this.authService.currentUserValue.anagraficaLavorativa[0].giorniFerie}setSlide(e){this.checkedFR=e.checked}setAutomaticSave(e){this.automaticSave=e.checked}getKmPercorsiFromChild(e){this.totKm+=e.km,this.totRimborsoKm+=e.km*this.authService.currentUserValue.rimborsoKm}minusKmPercorsiFromChild(e){this.totKm-=e.km,this.totRimborsoKm-=e.km*this.authService.currentUserValue.rimborsoKm}back(){this.timesheet=null,this.loadOption()}UpdateFieldTimesheet(e){this.timesheet.datiTimesheet[e.index][e.field]=e.dato,this.automaticSave&&(this.subs.sink=this.impiegatoService.submitDatoTImesheet(this.timesheet.datiTimesheet[e.index]).subscribe({next:i=>{console.log(i)}}))}checkTimesheetIsValid(){let e=!0;return this.timesheet.datiTimesheet.forEach(i=>{let a=0;Object.keys(i).forEach(c=>{["sede","clienteOre","straordinari","ferie","permessi","altro"].includes(c)&&(c==="altro"?a+=i[c]!=""?this.authService.currentUserValue.oreLavorative:0:a+=Number(i[c])||0)}),a<this.authService.currentUserValue.oreLavorative&&(e=!1)}),e}updateNgiustificativi(e){this.subs.sink=this.impiegatoService.submitNgiustificativi(Number(e.target.value),this.timesheet.id).subscribe({next:i=>{J("accent","Giustificativi aggiornati con successo","top","center",this.snackBar)}})}minusOrePermesso(e){this.rimanezaPermesso=e.action}minusOreFerie(e){this.rimanezaFerie=e.action}caricaGiustificativi(){let e=new FormData;e.append("file",this.fileUploadForm.get("uploadFile")?.value),this.loading=!0,this.subs.sink=this.impiegatoService.submitGiustificativoTimesheet(this.timesheet.id,e).subscribe({next:i=>{_e.default.fire("Giustificativi Caricati com successo!","sono stati caricati dei giustificativi per questo timesheet","success")},error:i=>{_e.default.fire("Ops Qualcosa \xE8 andato storto","","error")},complete:()=>{this.loading=!1}})}};n.\u0275fac=function(i){return new(i||n)(x(H),x(G),x(oe),x(he))},n.\u0275cmp=k({type:n,selectors:[["app-ricerca-timesheet"]],standalone:!0,features:[N([ii(ni)]),P,I],decls:22,vars:20,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[1,"container-fluid"],[1,"row"],[3,"title","items","active_item","hidden"],["class","row mb-3"],[1,"col-xl","col-lg","col-md"],[1,"card"],["class","row mt-5"],[1,"col-xl-2","col-lg-2","col-md-2"],[1,"col-xl-8","col-lg-8","col-md-8","col-sm-8"],["mat-flat-button","","color","primary","style","width: 100%;height: 5vh","class","mb-5","type","submit",3,"disabled"],[1,"row","mb-3"],[1,"col-xl-4","col-lg-4","col-md-4"],[1,"col-xl-4","col-lg-4","col-md-4","col-sm-4","pt-2","align-center","align-content-center"],[1,"col-xl-2","col-lg-2","col-md-2","align-center","justify-content-end"],[3,"opened","closed"],[1,"header"],["mat-raised-button","","color","primary"],["class","body"],["mat-raised-button","","color","primary",3,"click"],[1,"demo-google-material-icon"],[1,"material-icons"],[1,"icon-name"],[3,"change"],[1,"body"],[1,"container"],[3,"formGroup"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12","mb-4"],[2,"width","100%"],["matInput","","formControlName","selectPeriod",3,"matDatepicker"],["matIconSuffix","",3,"for"],["startView","multi-year","panelClass","example-month-picker",3,"monthSelected"],["dp",""],["mat-flat-button","","color","primary","type","submit",2,"width","100%","height","5vh",3,"disabled","click"],["appearance","outline",1,"example-full-width"],["formControlName","yearMonth"],[3,"value"],[1,"body",2,"width","100%"],[1,"container-fluid",2,"width","100%"],[3,"rimanenzaFerie","rimanenzaPermesso","disableMargin","timesheet","oreFerie","orePermesso","myEvent","timesheetEvent","myEvent2"],[1,"row","align-center","justify-content-center"],[1,"col-xl-8","col-lg-8","col-md-8","col-sm-8","pt-2","align-center","align-content-center"],[1,"row","mt-5"],[1,"body","table-responsive"],[1,"table","custom-table"],[1,"large-cell"],["type","number",1,"inputHid",3,"ngModel","ngModelChange","change"],["class","row"],[1,"example-container"],[1,"col-xl-12","col-lg-12","col-md-12","col-sm-12","mb-3"],["formControlName","uploadFile"],["mat-flat-button","","color","accent","type","submit",2,"width","100%","height","5vh",3,"disabled","click"],["mat-flat-button","","color","primary","type","submit",1,"mb-5",2,"width","100%","height","5vh",3,"disabled","click"]],template:function(i,a){i&1&&(r(0,"section",0)(1,"div",1)(2,"div",2)(3,"div",3)(4,"div",4),S(5,"app-breadcrumb",5)(6,"app-breadcrumb",5),l(),_(7,uo,18,4,"div",6),l()()(),r(8,"div",4),S(9,"div",7),r(10,"div")(11,"div",8),_(12,bo,12,4)(13,To,6,0),l()(),S(14,"div",7),l(),r(15,"div",4),_(16,wo,43,6,"div",9),l(),r(17,"div",4),S(18,"div",10),r(19,"div",11),_(20,Eo,2,1,"button",12),l(),S(21,"div",10),l()()),i&2&&(d(5),p("title","Data Timesheet "+(a.timesheet!=null?a.monthsInItalian[a.timesheet.mese]+" - "+a.timesheet.anno:""))("items",R(16,Ii))("active_item","Dettaglio Timesheet")("hidden",a.timesheet==null),d(),p("title","Gestione Timesheet")("items",R(17,Ii))("active_item","Ricerca Timesheet")("hidden",a.timesheet!=null),d(),y(7,a.timesheet!=null?7:-1),d(),M(a.timesheet==null?R(18,Fo):R(19,Mo)),d(2),ke(a.timesheet==null?"col-xl-10 col-lg-10 col-md-10 col-sm-10 justify-content-center":"col-xl-12 col-lg-12 col-md-12 col-sm-12"),d(2),y(12,a.laoding?13:12),d(4),y(16,a.authService.currentUserValue.rimborso&&a.timesheet!=null&&!a.laoding?16:-1),d(4),y(20,a.timesheet!=null?20:-1))},dependencies:[$,re,U,le,j,ae,se,me,$t,Ht,de,jt,Gt,ze,At,Kt,Lt,It,Vt,_i,Ot,ce,qt,Bt,Yt,Qt,pe,je,$e,Re,Di,Le,Te,Se,Ge,Ae,Ve,ue],styles:[".example-month-picker[_ngcontent-%COMP%]   .mat-calendar-body-cell-content[_ngcontent-%COMP%]{display:none}.table.custom-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{border:.5px solid #000}.table.custom-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td.large-cell[_ngcontent-%COMP%]{width:70%}.table.custom-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:not(.large-cell){width:30%}.inputHid[_ngcontent-%COMP%]{border:none;outline:none;width:100%;height:100%;box-sizing:border-box;padding:2px 5px;background:inherit;position:relative;z-index:1}"]});let t=n;return t})();var Do=()=>["Home"],lt=(()=>{let n=class n extends O{ngOnInit(){}constructor(){super()}};n.\u0275fac=function(i){return new(i||n)},n.\u0275cmp=k({type:n,selectors:[["app-dashboard"]],standalone:!0,features:[P,I],decls:4,vars:4,consts:[[1,"content"],[1,"content-block"],[1,"block-header"],[3,"title","items","active_item"]],template:function(i,a){i&1&&(r(0,"section",0)(1,"div",1)(2,"div",2),S(3,"app-breadcrumb",3),l()()()),i&2&&(d(3),p("title","Dashboad")("items",R(3,Do))("active_item","Dashboard"))},dependencies:[pe,xi]});let t=n;return t})();var Or=[{path:"",component:lt},{path:"home",component:lt},{path:"timesheet",component:Vi},{path:"riepilogoTimesheet",component:Pi},{path:"account",component:fi},{path:"**",redirectTo:"/page404",pathMatch:"full"}];export{Or as ImpiegatoRoutes};
